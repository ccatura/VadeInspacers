<html>
<head><title>VADE INSPACERS</title>

<!--REFERENCE SITES
	http://jsfiddle.net/kzXek/ 
	https://www.w3schools.com/howto/tryit.asp?filename=tryhow_js_animate_3
	
	http://jqfundamentals.com/chapter/jquery-basics
-->


<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css"> <!--bootstrap-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> <!--bootstrap-->
<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script> <!--bootstrap-->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script> <!--jquery-->

<style>
@font-face {
	font-family: 'PixelEmulator-xq08';
	src: url('fonts/PixelEmulator-xq08.ttf');
	format('truetype');
}

body {
	font-family: 'PixelEmulator-xq08';
	font-size: 32px;
	background-color: #000000;
	color: #ffffff;
	margin: 0px 0px 0px 0px;
	line-height: 28px;
	overflow: hidden;
}

.topHeader {
	text-align: center;
}

.bottomFooter {
	text-align: left;
	position: absolute;
	bottom: 1px;
}

.centerParagraph {
	text-align: center;
	position: relative;
	top: 100px;
}

#player {
	width: 100px;
	position: absolute;
	bottom: 70px;
}

#enemy {
	width: 100px;
	position: absolute;
	left: 50px;
	bottom: 500px;
}

#playerBullet {
	width: 7px;
	height 40px;
	position: absolute;
	background: #ffffff;
}

#enemyBullet {
	width: 7px;
	height 40px;
	position: absolute;
	background: #ff0000;
	left: 50px;
	bottom: 100px;
}

#blinker {
	opacity: 1;
}

</style>

<script>

function game() {
	var score = 0; //resets score
	var playerPos = (($(window).width() / 2) - ($(player).width() / 2)); //starts player in middle of screen
	var bottomPos = 70;
	var player = document.getElementById("player"); //sets player graphic to player variable
	var enemy = document.getElementById("enemy"); //sets enemy graphic to player variable
	var playerBullet = document.getElementById("playerBullet"); //sets playerBullet graphic to playerBullet variable
	var enemyBullet = document.getElementById("enemyBullet"); //sets enemyBullet graphic to enemyBullet variable
	var playerBulletSpeed = 3;
	var speed = 1; //speed of player
	var playerPadding = 10; //padding between player and sides of screen
	
	var moveLeft = 0; //left movement "boolean"
	var moveRight = 0; //right movement "boolean"
	
	var sound1 = document.getElementById("shootSound");
	var bg_lo = document.getElementById("bg_lo");
	var bg_hi = document.getElementById("bg_hi");
	var bg_toggle = "bg_lo";
	var bgMusicSpeed = 1000;
	var musicOn = 1;
	var enemyState = 1;
	var blinkSpeed = 500;

	setInterval(movePlayer, 1); //sets player movement ani
	setInterval(blinker, 500); //sets blinking 1up ani
	setInterval(moveEnemy, 500);
	setInterval(function () {checkCollision(enemy, playerBullet)}, 5);
	var bgPlay = setInterval(bgMusic, bgMusicSpeed); //sets bg music



		function checkCollision(character, amunition) {
			//if $(playerBullet).is(':animated') // save this for later to check if bullet is animated
			var characterLeftX 		= parseInt($(character).css("left"));
			var characterRightX 	= parseInt($(character).css("left")) + parseInt($(enemy).css("width"));
			var characterTopY 		= parseInt($(character).css("bottom"));
			var characterBottomY 	= parseInt($(character).css("bottom")) - parseInt($(enemy).css("height"));
			//console.log("CL " + characterLeftX + "   CR " + characterRightX);
			//console.log("CT " + characterTopY + "   CB " + characterBottomY);
			
			var ammunitionLeftX 	= parseInt($(amunition).css("left"));
			var ammunitionRightX 	= parseInt($(amunition).css("left")) + parseInt($(playerBullet).css("width"));
			var ammunitionTopY 		= parseInt($(amunition).css("bottom"));
			var ammunitionBottomY 	= parseInt($(amunition).css("bottom")) - parseInt($(playerBullet).css("height"));
			//console.log("AL " + ammunitionLeftX + "   AR " + ammunitionRightX);
			//console.log("AT " + ammunitionTopY + "   AB " + ammunitionBottomY);

			
			if (ammunitionLeftX   > characterLeftX 	&&
				ammunitionRightX  < characterRightX &&
				ammunitionTopY    < characterTopY 	&&
				ammunitionBottomY > characterBottomY) {
					console.log("ouch");
					//hitEnemySound.play();
					$('#hitEnemySound').trigger('play');
			}

	}


/***************************************************
***************************************************
***************************************************
***************************************************
***************************************************
***************************************************
fix sounds to be consistant.... some are #bg_lo, some are bg_lo
some are jquery and some are javascript
***************************************************
***************************************************
***************************************************
***************************************************
***************************************************/




	function movePlayer() {
		if (moveLeft) { //moves player to left
			if (!(playerPos < playerPadding)) {
				if (playerPos > $(window).width() - (($(player).width() + playerPadding))) {
					playerPos = $(window).width() - ($(player).width() + playerPadding);
				}
					player.style.left = (playerPos-= speed) + "px";
					//console.log("Moving Left");
			}
		} else if (moveRight) { //moves player to right
			if (!(playerPos > $(window).width() - ($(player).width() + playerPadding))) {
				player.style.left = (playerPos+= speed) + "px";
				//console.log("Moving Right");
			}
		} else { //does not move player
			//console.log("Stopped");
		}
	}
	
	function moveEnemy() {
		var enemyX = Math.floor((Math.random() * (($(window).width()) - 200)) + 50);
		var enemyY = Math.floor((Math.random() * (($(window).height()) - 400)) + 200);
		$(enemy).animate({left: enemyX, bottom: enemyY}, 1000, "linear");
		//console.log(enemyX + "  " + enemyY);
	}

	function blinker() { //makes 1up on top of screen blink
		$('#blinker').fadeOut(blinkSpeed);
		$('#blinker').fadeIn(blinkSpeed);
	}

	function bang() {
		$(playerBullet).animate({bottom: $(window).height()}, 1000, "linear");
		//console.log("Bottom: " + playerBullet.style.bottom + " Left: " + playerBullet.style.left);
	}
	
	function bgMusic () {

			if (bgMusicSpeed > 260) bgMusicSpeed-= 5;
				if (bg_toggle == "bg_hi") {
					if (musicOn == 1) $('#bg_hi').trigger('play');
					$(enemy).attr("src", "images/enemyB.gif"); //animate enemy
					bg_toggle = "bg_lo";
				} else {
					if (musicOn == 1) $('#bg_lo').trigger('play');
					$(enemy).attr("src", "images/enemyA.gif"); //animate enemy
					bg_toggle = "bg_hi";
				}
		
		clearInterval(bgPlay);
		bgPlay = setInterval(bgMusic, bgMusicSpeed);
		//console.log("Enemy Bottom: " + enemy.style.bottom + " Left: " + enemy.style.left);
	}




	
	document.getElementById("score").innerHTML = score; //set initial score
	player.style.left = playerPos + "px"; //set initial position of player
	player.style.bottom = bottomPos + "px"; //set initial position of player
	playerBullet.style.left = playerPos + 50 + "px"; //set initial position of playerBullet
	playerBullet.style.bottom = "1600px"; //set initial position of playerBullet
	





	$(document).ready(function() {
		$(document).keydown(function (e) {
			ek = e.keyCode
			$(".centerParagraph").css("display", "none"); //makes instruction dissapear when first key is pressed
			document.getElementById("credit").innerHTML = "0"; //changes credit to zero when game starts
			if (ek == 77) {if (musicOn == 1) {musicOn = 0} else {musicOn = 1};} //msuic toggle
			if (ek == 37) {moveLeft = 1;} //while left arrow key pressed, move state enabled
			if (ek == 39) {moveRight = 1;} //while right arrow key pressed, move state enabled
			if (ek == 32 && (!$(playerBullet).is(':animated'))) { //if space key pressed & playerBullet not already animating, then process
					sound1.play(); //plays the bang sound (the shoot sound)
					$(playerBullet).css("bottom", bottomPos + 30); //reset playerBullet position from bottom
					$(playerBullet).css("left", playerPos + 50); //reset playerBullet position from left
					bang();
					//console.log("Bang!");
			}
			});

		$(document).keyup(function (e) { //these help smooth the movement of the player
			ek = e.keyCode
			if (ek == 37) {moveLeft = 0;} //when left arrow key not pressed, move state disabled
			if (ek == 39) {moveRight = 0;} //when right arrow key not pressed, move state disabled
			});
	});
}
</script>







</head>
<body onLoad="game();">

<!-- setup game sounds -->
<audio id="shootSound"><source src="sounds/shoot.wav" type="audio/wav"></audio>
<audio id="hitEnemySound"><source src="sounds/invaderkilled.wav" type="audio/wav"></audio>
<audio id="bg_hi"><source src="sounds/bg_hi.wav" type="audio/wav"></audio>
<audio id="bg_lo"><source src="sounds/bg_lo.wav" type="audio/wav"></audio>

<span class="bottomFooter">
<hr style="width: 1000%; margin: 0px; border: 1px solid #ffffff;">
CREDIT <span id="credit">1</span></span>


<!-- top header -- title, score, etc -->
<!-- using some bootstrap for ease of alignment -->
<div class="topHeader">
<span style="color: #00aa00;">VADE INSPACERS</span><br>
<span class="col-md-6"><span id="blinker">1UP</span></span>
<span class="col-md-6">2UP</span><br>

<span class="col-md-6"><span id="score"></span></span>
<span class="col-md-6"><span id="score">0</span></span>
</div>


<!-- setup graphics -->
<div id="playerBullet">&nbsp;</div>
<div id="enemyBullet">&nbsp;</div>
<img id="player" src="images/player.png">
<img id="enemy" src="images/enemyA.gif">



<!-- instructions -->
<div class="centerParagraph">
Shoot the aliens!<br><br>
'LEFT/RIGHT' keys to move<br>
'SPACE' to fire<br>
'M' to toggle music<br><br>
Press any key to start
</div>














</body>

</html>